# Разработка модели эффективного воспроизводства молочного стада хозяйства «Вольный луг»

## Описание проекта
По просьбе владелца молочного хозяйства «Вольный луг» необходимо разработать модель эффективного воспроизводства его молочного стада. Он хочет купить бурёнок, чтобы расширить поголовье стада коров. Для этого он заключил выгодный контракт с ассоциацией пастбищ «ЭкоФерма».   \
Условия позволяют фермеру очень тщательно отобрать коров. Он определяет качество молока по строгой методике, и при этом ему нужно выполнять свой план развития молочного хозяйства. Фермер хочет, чтобы каждая бурёнка давала не менее 6000 килограммов молока в год, а надой был вкусным — строго по его критериям, ничуть не хуже. А продавцы и технологи так и норовят приукрасить своих бурёнок!
Поэтому он просит нас разработать модель машинного обучения, которая поможет ему управлять рисками и принимать объективное решение о покупке. «ЭкоФерма» готова предоставить подробные данные о своих коровах. Нам нужно создать две прогнозные модели для отбора бурёнок в поголовье:
1.	Первая будет прогнозировать возможный удой у коровы (целевой признак Удой)
2.	Вторая — рассчитывать вероятность получить вкусное молоко от коровы (целевой признак Вкус молока)

С помощью модели нужно отобрать коров по двум критериям:  
- Средний удой за год — не менее 6000 килограммов
- Молоко должно быть вкусным

## Описание данных

Предоставлены данные о стаде фермера на текущий момент. Также предоставлены данные о коровах «ЭкоФермы», которых фермер хочет изучить перед покупкой. 

`ferma_main.csv`  

`ferma_dad.csv`   

`cow_buy_old.csv`    

Файл `ferma_main.csv` содержит данные о стаде фермера на текущий момент. 

Описание таблицы: 

***Параметры корма коровы***
- `ЭКЕ (Энергетическая кормовая единица)` — измерение питательности корма коровы;
- `Сырой протеин` — содержание сырого протеина в корме, в граммах;
- `СПО (Сахаро-протеиновое соотношение)` — отношение сахара к протеину в корме коровы.

***Где паслась корова***  
- `Тип пастбища` — ландшафт лугов, на которых паслась корова.  

***Особенности коровы***  
- `id` — номер коровы;  
- `Порода` — порода коровы;  
- `Возраст` — бинарный признак (менее_2_лет, более_2_лет);  
- `Имя Папы` — порода папы коровы.    

***Характеристики молока***  
- `Жирность` — содержание жиров в молоке, в процентах;
- `Белок` — содержание белков в молоке, в процентах;
- `Вкус молока` — оценка вкуса по личным критериям фермера;
- `Удой` — масса молока, которую корова даёт в год, в килограммах.  

Файл `ferma_dad.csv` хранит имя папы каждой коровы в стаде фермера.
Файл `cow_buy_old.csv` — это данные о коровах «ЭкоФермы», которых фермер хочет изучить перед покупкой. Структура таблицы почти аналогична `ferma_main.csv`, кроме нескольких особенностей:
- `Белок` и `Жирность` молока указаны на момент покупки — когда «ЭкоФерма» давала им свой корм.
- Параметры кормления `ЭКЕ`, `Сырой протеин`, `СПО` отсутствуют. Недавно технологи заказчика пересмотрели параметры корма и планируют их внедрить после расширения стада. Именно новые параметры нужно использовать, когда вы будете применять предсказательные модели к бурёнкам «ЭкоФермы». По новой схеме фермер планирует увеличить средние значения `ЭКЕ`, `Сырой протеин`, `СПО` на 5%.
- `Удой` и `Вкус молока` неизвестны — именно их и предстоит предсказать!

## План работы

- Загрузим и проанализируем предоставленные данные    
- Проведём иследования полученных данных с их визуализацией  
- Проведем корреляционный анализ  
- Решим задачу обучения модели линейной регрессии  
- Решим задачу обучения модели логистической регрессии  
- Сделаем итоговые выводы  

## Итоговые выводы

***Проведенный анализ показал, что 3 коровы удовлетворяют требованиями фермера для приобритения этих буренок.*** 
- В процессе обучения модели линейной ригреесси и построения более точной модели, мы воспользовалдись добавлением нового признака. Перевели `СПО (Сахаро-протеиновое соотношение)` в категориальный признак, выявив и использовав границу нелинейности. Ввели новый признак `ЭКЕ в квадрате`. Данная модель была более точной, чем предыдущая. 
- Далее дополнительно ввели в категориальный признак  `Имя папы`. Данная модель показала максимальную точность. На основе этой модели строили прогноз по удоям буренок ассоциации пастбищ "ЭкоФерма". 
- Построили модель логистической регрессии на данных датасета farm_main.csv. Получили данные по целевому признаку `Вкус молока`. Выявили список коров со вкусным молоком. 
- Объеденили полученняе данные и выявили перечень из 3 коров с удовлетворяющими для заказчика требованиями по удоям годовых более 6000 кг и со вкусным молоком.
- Самое оптимальное значение порога — 0.83. При минимальном значении критической ошибки мы получаем 3 коровы как количество истинно-положительного результата целевого признака вкуса молока.
- Фермер, учитывая свои требования к объему удоев и качеству молока, может купить 3 коровы из стада с минимальным риском для себя.
